@page "/iframe.html"
@layout NullLayout
@implements IAsyncDisposable
@inject IJSRuntime JSRuntime

<style>
    body{
        background-size: 100px 100px, 100px 100px, 20px 20px, 20px 20px !important;
        background-position: 0px 0px, 0px 0px, 0px 0px, 0px 0px !important;
        background-blend-mode: difference !important;
        background-image: linear-gradient(rgba(130, 130, 130, 0.5) 1px, transparent 1px), linear-gradient(90deg, rgba(130, 130, 130, 0.5) 1px, transparent 1px), linear-gradient(rgba(130, 130, 130, 0.25) 1px, transparent 1px), linear-gradient(90deg, rgba(130, 130, 130, 0.25) 1px, transparent 1px) !important;
    }
</style>

<IdQueryRouter>
    <CanvasFrame />
</IdQueryRouter>

@code
{
    private readonly JSModule _JSModule;

    public IFrame()
    {
        this._JSModule = new(() => this.JSRuntime, "./_content/BlazingStory/Internals/Pages/IFrame.razor.js");
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender) return;
        await this._JSModule.InvokeVoidAsync("initializeCanvasFrame");
    }

    public async ValueTask DisposeAsync()
    {
        await this._JSModule.DisposeAsync();    
    }
}