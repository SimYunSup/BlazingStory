@using System.Web;
@inject NavigationManager NavigationManager

<CascadingValue Value="_RouteData">
    @ChildContent
</CascadingValue>

@code {
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    private PathQueryRoutData _RouteData = new(path: "");

    protected override void OnInitialized()
    {
        this.NavigationManager.LocationChanged += NavigationManager_LocationChanged;
        NavigationManager_LocationChanged(this, new LocationChangedEventArgs(this.NavigationManager.Uri, false));
    }

    private void NavigationManager_LocationChanged(object? sender, LocationChangedEventArgs args)
    {
        var uri = new Uri(args.Location);
        var queryStrings = HttpUtility.ParseQueryString(uri.Query);
        var path = queryStrings["path"] ?? "";
        if (this._RouteData.Path != path)
        {
            this._RouteData = new(path);
            this.StateHasChanged();
        }
    }
}